import{createPhoneMask,checkPhoneFocus}from"./phone-mask.js";import{saveFormData,fillForm}from"./local-storage.js";import{showSuccessMessage}from"./message.js";const forms=document.querySelectorAll("[name=feedback-form]"),phoneInputs=document.querySelectorAll('input[type="tel"]'),phoneRegex=/^((\+7|7|8)+([0-9]){10})$/,errorMessage="Пожалуйста, проверьте правильность введенных данных",addErrorOnInput=e=>{const t=e.closest(".form-control").querySelector("p");e.style.border="1px solid #fe7865",t.style.display="block"},removeErrorFromInput=e=>{const t=e.closest(".form-control").querySelector("p");e.style.border="1px solid #2c2e3f",t.style.display="none"},checkPhoneField=(e,t)=>{const r=t.value.replace(/\D/g,"");e.test(r)?(removeErrorFromInput(t),t.setCustomValidity("")):(addErrorOnInput(t),t.setCustomValidity(errorMessage)),t.reportValidity()},phoneInputListeners=()=>{phoneInputs.forEach((e=>{checkPhoneFocus(e),e.addEventListener("keypress",(e=>{/\d/.test(e.key)||e.preventDefault()})),e.addEventListener("input",createPhoneMask),e.addEventListener("input",(e=>{checkPhoneField(phoneRegex,e.target)}))}))},formSubmit=()=>{forms.forEach((e=>{const t=e.querySelector('input[type="tel"]'),r=e.querySelector('input[type="email"]');t.removeAttribute("pattern"),fillForm(t,r),e.addEventListener("submit",(e=>{e.preventDefault(),saveFormData(t,r),showSuccessMessage()}))}))};export{phoneInputListeners,formSubmit};